!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findObjEvt=function(e,t,n,o){e.preventDefault();var i=getComputedStyle(e.target),a=i.getPropertyValue("transform"),r=i.getPropertyValue("transform-origin").replace(/px/g,"").split(" ");r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1]),r[2]=parseFloat(r[2]||0);var s=new THREE.Matrix4;if(s.identity(),/^matrix\(/.test(a)){var l=a.replace(/^matrix\(|\)$/g,"").split(" ");s.elements[0]=parseFloat(l[0]),s.elements[1]=parseFloat(l[1]),s.elements[4]=parseFloat(l[2]),s.elements[5]=parseFloat(l[3]),s.elements[12]=parseFloat(l[4]),s.elements[13]=parseFloat(l[5])}else if(/^matrix3d\(/i.test(a))for(var l=a.replace(/^matrix3d\(|\)$/gi,"").split(" "),d=0;d<16;d++)s.elements[d]=parseFloat(l[d]);var c=new THREE.Matrix4;c.makeTranslation(r[0],r[1],r[2]),c.multiply(s),s.makeTranslation(-r[0],-r[1],-r[2]),c.multiply(s);var p=new THREE.Vector3(e.layerX,e.layerY,0);p.applyMatrix4(c);var u=parseFloat(i.getPropertyValue("width")),E=parseFloat(i.getPropertyValue("height")),m=new THREE.Vector3(p.x/u*2-1,-p.y/E*2+1,.5);m.unproject(t),m.sub(t.position),m.normalize();var h=new THREE.Raycaster(t.position,m);if(0==o){var v=h.intersectObject(n);console.log(n)}else if(1==o){var v=h.intersectObjects(n.children,!0);console.log(n)}if(v.length>0){var f=v;return f}}},function(e,t,n){"use strict";var o=n(0),i=function(){var e=new THREE.Object3D,t=new THREE.Mesh(new THREE.BoxGeometry(1,1,.1,1,1,1),new THREE.MeshLambertMaterial({color:16777215}));t.position.z=-.5,e.add(t),(t=t.clone()).position.z=.5,e.add(t),(t=t.clone()).position.z=0,t.position.x=-.5,t.rotation.y=Math.PI/2,e.add(t),(t=t.clone()).position.x=.5,e.add(t),(t=t.clone()).position.x=0,t.position.y=-.5,t.rotation.y=0,t.rotation.x=Math.PI/2,e.add(t);var n=e.children.slice(),o=new THREE.Object3D;return o.position.y=.5,o.position.x=.5,(t=t.clone()).position.y=0,t.position.x=-.5,o.add(t),e.add(o),n.push(t),e.position.z=.5,e.rotation.x=Math.PI/2,e.open=!1,e.tick=function(){o.rotation.z+=.1*((e.open?-Math.PI/1.5:0)-o.rotation.z)},{box:e,walls:n}},a=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(.5,8,8),new THREE.MeshNormalMaterial);return e.material.shading=THREE.FlatShading,e.position.z=.5,e},r=(i=function(){var e=new THREE.BoxGeometry(1,1,1),t=new THREE.MeshNormalMaterial,n=new THREE.Mesh(e,t);return n.position.z=.5,n.position.x=1.5,n},function(e,t,n,o,i,a){var r=new THREE.Object3D,s=new THREE.Shape;s.moveTo(t,n+50),s.lineTo(t,n+a-50),s.quadraticCurveTo(t,n+a,t+50,n+a),s.lineTo(t+i-50,n+a),s.quadraticCurveTo(t+i,n+a,t+i,n+a-50),s.lineTo(t+i,n+50),s.quadraticCurveTo(t+i,n,t+i-50,n),s.lineTo(t+50,n),s.quadraticCurveTo(t,n,t,n+50);var l=new THREE.ShapeGeometry(s),d=new THREE.MeshBasicMaterial({color:3381759}),c=new THREE.Mesh(l,d);return c.rotation.set(Math.PI/2,-Math.PI/2e3,Math.PI),c.position.z=o,c.position.x=-t,c.position.y=0,(new THREE.FontLoader).load("Data/helvetiker_regular.typeface.json",function(n){var i=new THREE.TextGeometry(e,{font:n,size:80,height:5,curveSegments:12,bevelEnabled:!0,bevelThickness:10,bevelSize:8,bevelSegments:5}),a=new THREE.MeshPhongMaterial({color:16711680}),s=new THREE.Mesh(i,a);s.rotation.set(-Math.PI/2,-Math.PI/2e3,Math.PI),s.position.z=o-200,s.position.x=t>=0?-t-100:500-t,r.add(s)}),r.add(c),r.scale.set(.0019,.0019,.0019),r});function s(e,t,n){t.setPatternDetectionMode(artoolkit.AR_MATRIX_CODE_DETECTION),document.body.className=t.orientation;var s,l=new THREE.WebGLRenderer({antialias:!0});if("portrait"===t.orientation){var d=window.innerWidth/t.videoHeight*t.videoWidth,c=window.innerWidth;l.setSize(d,c),l.domElement.style.paddingBottom=d-c+"px"}else if(/Android|mobile|iPad|iPhone/i.test(navigator.userAgent))l.setSize(window.innerWidth,window.innerWidth/t.videoWidth*t.videoHeight);else{window.innerWidth,window.innerHeight;l.setSize(window.innerWidth,window.innerHeight),document.body.className+=" desktop"}document.body.insertBefore(l.domElement,document.body.firstChild),(s=new THREE.PointLight(16777215)).position.set(40,40,40),e.scene.add(s),(s=new THREE.PointLight(16746496)).position.set(-40,-20,-30),e.scene.add(s);var p=i(),u=a(),E=a(),m=(p=i(),r("I'm a box",-600,1,1e3,750,300));m.visible=!1,E.position.z=3;var h=t.createThreeBarcodeMarker(5);h.add(p),h.add(m),e.scene.add(h);var v=new THREE.Scene;(new THREE.OBJLoader2).load("./model/all3KidneySamples.obj",function(e){e.rotation.set(-Math.PI/2,-Math.PI/2e3,Math.PI),e.scale.set(.03,.03,.03),v.add(e)}),h.add(v),e.scene.add(h);var f=0,w=0;l.domElement.addEventListener("click",function(t){(0,o.findObjEvt)(t,e.camera,u,0)&&(t.preventDefault(),w+=1,plane.visible=!plane.visible),(0,o.findObjEvt)(t,e.camera,p,0)&&(m.visible=!m.visible),(0,o.findObjEvt)(t,e.camera,v,1)&&(document.getElementById("overlay").style.opacity=1,document.getElementById("overlay").style.right=0,document.getElementById("overlay").style.transition="opacity 1s, right 1s")},!1);!function t(){e.process(),f+=.05*(w-u.rotation.z),u.rotation.z+=f,f*=.8,e.renderOn(l),requestAnimationFrame(t)}()}window.ARThreeOnLoad=function(){navigator.mediaDevices.enumerateDevices().then(function(e){var t=e.find(function(e){return-1!==e.label.indexOf("back")});!function(e){ARController.getUserMediaThreeScene({width:{min:1024,ideal:1280,max:1920},height:{min:576,ideal:720,max:1080},cameraParam:"Data/camera_para-iPhone 6 Plus rear 1280x720 1.0m.dat",deviceId:e.deviceId,onSuccess:s})}({deviceId:t?{exact:t.deviceId}:void 0})}).catch(function(e){alert(e.name+": "+e.message)})},window.ARController&&ARController.getUserMediaThreeScene&&ARThreeOnLoad()}]);