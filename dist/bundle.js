!function(e){var t={};function a(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t){var a=function(e,t,a){var o=getComputedStyle(e.target),r=o.getPropertyValue("transform"),n=o.getPropertyValue("transform-origin").replace(/px/g,"").split(" ");n[0]=parseFloat(n[0]),n[1]=parseFloat(n[1]),n[2]=parseFloat(n[2]||0);var i=new THREE.Matrix4;if(i.identity(),/^matrix\(/.test(r)){var s=r.replace(/^matrix\(|\)$/g,"").split(" ");i.elements[0]=parseFloat(s[0]),i.elements[1]=parseFloat(s[1]),i.elements[4]=parseFloat(s[2]),i.elements[5]=parseFloat(s[3]),i.elements[12]=parseFloat(s[4]),i.elements[13]=parseFloat(s[5])}else if(/^matrix3d\(/i.test(r)){s=r.replace(/^matrix3d\(|\)$/gi,"").split(" ");for(var l=0;l<16;l++)i.elements[l]=parseFloat(s[l])}var d=new THREE.Matrix4;d.makeTranslation(n[0],n[1],n[2]),d.multiply(i),i.makeTranslation(-n[0],-n[1],-n[2]),d.multiply(i);var c=new THREE.Vector3(e.layerX,e.layerY,0);c.applyMatrix4(d);var p=parseFloat(o.getPropertyValue("width")),u=parseFloat(o.getPropertyValue("height")),m=new THREE.Vector3(c.x/p*2-1,-c.y/u*2+1,.5);m.unproject(t),m.sub(t.position),m.normalize(),console.log(a);var E=new THREE.Raycaster(t.position,m).intersectObject(a);if(E.length>0)return E},o=function(e,t,a){var o=getComputedStyle(e.target),r=o.getPropertyValue("transform"),n=o.getPropertyValue("transform-origin").replace(/px/g,"").split(" ");n[0]=parseFloat(n[0]),n[1]=parseFloat(n[1]),n[2]=parseFloat(n[2]||0);var i=new THREE.Matrix4;if(i.identity(),/^matrix\(/.test(r)){var s=r.replace(/^matrix\(|\)$/g,"").split(" ");i.elements[0]=parseFloat(s[0]),i.elements[1]=parseFloat(s[1]),i.elements[4]=parseFloat(s[2]),i.elements[5]=parseFloat(s[3]),i.elements[12]=parseFloat(s[4]),i.elements[13]=parseFloat(s[5])}else if(/^matrix3d\(/i.test(r)){s=r.replace(/^matrix3d\(|\)$/gi,"").split(" ");for(var l=0;l<16;l++)i.elements[l]=parseFloat(s[l])}var d=new THREE.Matrix4;d.makeTranslation(n[0],n[1],n[2]),d.multiply(i),i.makeTranslation(-n[0],-n[1],-n[2]),d.multiply(i);var c=new THREE.Vector3(e.layerX,e.layerY,0);c.applyMatrix4(d);var p=parseFloat(o.getPropertyValue("width")),u=parseFloat(o.getPropertyValue("height")),m=new THREE.Vector3(c.x/p*2-1,-c.y/u*2+1,.5);m.unproject(t),m.sub(t.position),m.normalize(),console.log(a);var E=new THREE.Raycaster(t.position,m).intersectObjects(a.children,!0);if(E.length>0)return E},r=function(){var e=new THREE.Object3D,t=new THREE.Mesh(new THREE.BoxGeometry(1,1,.1,1,1,1),new THREE.MeshLambertMaterial({color:16777215}));t.position.z=-.5,e.add(t),(t=t.clone()).position.z=.5,e.add(t),(t=t.clone()).position.z=0,t.position.x=-.5,t.rotation.y=Math.PI/2,e.add(t),(t=t.clone()).position.x=.5,e.add(t),(t=t.clone()).position.x=0,t.position.y=-.5,t.rotation.y=0,t.rotation.x=Math.PI/2,e.add(t);var a=e.children.slice(),o=new THREE.Object3D;return o.position.y=.5,o.position.x=.5,(t=t.clone()).position.y=0,t.position.x=-.5,o.add(t),e.add(o),a.push(t),e.position.z=.5,e.rotation.x=Math.PI/2,e.open=!1,e.tick=function(){o.rotation.z+=.1*((e.open?-Math.PI/1.5:0)-o.rotation.z)},{box:e,walls:a}},n=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(.5,8,8),new THREE.MeshNormalMaterial);return e.material.shading=THREE.FlatShading,e.position.z=.5,e},i=(r=function(){var e=new THREE.BoxGeometry(1,1,1),t=new THREE.MeshNormalMaterial,a=new THREE.Mesh(e,t);return a.position.z=.5,a.position.x=1.5,a},function(e,t,a,o,r,n){radius=50;var i=new THREE.Object3D,s=new THREE.Shape;s.moveTo(t,a+radius),s.lineTo(t,a+n-radius),s.quadraticCurveTo(t,a+n,t+radius,a+n),s.lineTo(t+r-radius,a+n),s.quadraticCurveTo(t+r,a+n,t+r,a+n-radius),s.lineTo(t+r,a+radius),s.quadraticCurveTo(t+r,a,t+r-radius,a),s.lineTo(t+radius,a),s.quadraticCurveTo(t,a,t,a+radius);var l=new THREE.ShapeGeometry(s),d=new THREE.MeshBasicMaterial({color:3381759}),c=new THREE.Mesh(l,d);return c.rotation.set(Math.PI/2,-Math.PI/2e3,Math.PI),c.position.z=o,c.position.x=-t,c.position.y=0,(new THREE.FontLoader).load("Data/helvetiker_regular.typeface.json",function(a){var r=new THREE.TextGeometry(e,{font:a,size:80,height:5,curveSegments:12,bevelEnabled:!0,bevelThickness:10,bevelSize:8,bevelSegments:5}),n=new THREE.MeshPhongMaterial({color:16711680}),s=new THREE.Mesh(r,n);s.rotation.set(-Math.PI/2,-Math.PI/2e3,Math.PI),s.position.z=o-200,s.position.x=t>=0?-t-100:500-t,i.add(s)}),i.add(c),i.scale.set(.0019,.0019,.0019),i}),s=function(){var e=new THREE.Object3D;return(new THREE.GLTF2Loader).load("https://raw.githubusercontent.com/mrdoob/three.js/master/examples/models/gltf/Duck/glTF-Embedded/Duck.gltf",function(t){t.scene.rotation.set(-Math.PI/2,-Math.PI/2e3,Math.PI),e.add(t.asset)}),e};function l(e,t,l){t.setPatternDetectionMode(artoolkit.AR_MATRIX_CODE_DETECTION),document.body.className=t.orientation;var d,c=new THREE.WebGLRenderer({antialias:!0});if("portrait"===t.orientation){var p=window.innerWidth/t.videoHeight*t.videoWidth,u=window.innerWidth;c.setSize(p,u),c.domElement.style.paddingBottom=p-u+"px"}else/Android|mobile|iPad|iPhone/i.test(navigator.userAgent)?c.setSize(window.innerWidth,window.innerWidth/t.videoWidth*t.videoHeight):(c.setSize(t.videoWidth,t.videoHeight),document.body.className+=" desktop");document.body.insertBefore(c.domElement,document.body.firstChild),(d=new THREE.PointLight(16777215)).position.set(40,40,40),e.scene.add(d),(d=new THREE.PointLight(16746496)).position.set(-40,-20,-30),e.scene.add(d);var m=r(),E=n(),h=n(),v=(m=r(),i("I'm a box",-600,1,1e3,750,300)),T=s();v.visible=!1,h.position.z=3,c.domElement.addEventListener("click",function(t){a(t,e.camera,E)&&(t.preventDefault(),f+=1,plane.visible=!plane.visible),a(t,e.camera,m)&&(v.visible=!v.visible),o(t,e.camera,T)&&(window.open("https://www.google.com","_self"),url="https://www.google.com",console.log("user come from: "+url))},!1);var w=t.createThreeBarcodeMarker(5);w.add(m),w.add(v),w.add(T),e.scene.add(w);T=new THREE.Object3D;(new THREE.GLTF2Loader).load("https://raw.githubusercontent.com/mrdoob/three.js/master/examples/models/gltf/Duck/glTF-Embedded/Duck.gltf",function(t){var a=t.scene;a.rotation.set(-Math.PI/2,-Math.PI/2e3,Math.PI),T.add(a),w.add(T),e.scene.add(w)});var g=0,f=0,R=function(){e.process(),g+=.05*(f-E.rotation.z),E.rotation.z+=g,g*=.8,e.renderOn(c),requestAnimationFrame(R)};R()}window.ARThreeOnLoad=function(){navigator.mediaDevices.enumerateDevices().then(function(e){var t=e.find(function(e){return-1!==e.label.indexOf("back")});!function(e){ARController.getUserMediaThreeScene({maxARVideoSize:640,cameraParam:"Data/camera_para.dat",deviceId:e.deviceId,onSuccess:l})}({deviceId:t?{exact:t.deviceId}:void 0})}).catch(function(e){alert(e.name+": "+e.message)})},window.ARController&&ARController.getUserMediaThreeScene&&ARThreeOnLoad()}]);